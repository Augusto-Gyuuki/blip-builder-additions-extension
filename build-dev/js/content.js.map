{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/content/Content.ts","webpack:///./src/content/features/AutoTag.ts","webpack:///./src/content/features/FeatureBase.ts","webpack:///./src/shared/Storager.ts","webpack:///./src/shared/Utils.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFa;AACb;AACA;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,iEAAiE,uBAAuB,EAAE,4BAA4B;AACrJ;AACA,KAAK;AACL;AACA,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,oDAAoB;AAC/C,gBAAgB,mBAAO,CAAC,8CAAiB;AACzC,kBAAkB,mBAAO,CAAC,6DAAoB;AAC9C;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;;;;;;;;;;;;;ACpCY;AACb;AACA;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,iEAAiE,uBAAuB,EAAE,4BAA4B;AACrJ;AACA,KAAK;AACL;AACA,8CAA8C,cAAc;AAC5D,gBAAgB,mBAAO,CAAC,iDAAoB;AAC5C,sBAAsB,mBAAO,CAAC,4DAAe;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;;;;;;;;;;;;AC9Ca;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AChBa;AACb;AACA;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,iEAAiE,uBAAuB,EAAE,4BAA4B;AACrJ;AACA,KAAK;AACL;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,CAAC;;;;;;;;;;;;;AC/EY;AACb;AACA;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,iEAAiE,uBAAuB,EAAE,4BAA4B;AACrJ;AACA,KAAK;AACL;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL,CAAC;AACD;AACA","file":"content.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/content/Content.ts\");\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Storager_1 = require(\"../shared/Storager\");\r\nconst Utils_1 = require(\"../shared/Utils\");\r\nconst AutoTag_1 = require(\"./features/AutoTag\");\r\nexports.isBuilderLoaded = false;\r\nexports.features = [\r\n    {\r\n        name: \"autotag\",\r\n        processor: new AutoTag_1.default(),\r\n    },\r\n];\r\n((brow) => __awaiter(this, void 0, void 0, function* () {\r\n    exports.features.forEach((f) => __awaiter(this, void 0, void 0, function* () {\r\n        const configuration = yield Storager_1.default.get(f.name);\r\n        f.processor.OnReceiveConfiguration(configuration);\r\n        if (configuration && configuration.enabled) {\r\n            f.processor.OnEnableFeature();\r\n        }\r\n    }));\r\n    setInterval(() => __awaiter(this, void 0, void 0, function* () {\r\n        const isLoading = yield Utils_1.default.getBuilderControllerVariable(\"isLoading\");\r\n        const isLoaded = isLoading === false;\r\n        if (isLoaded && isLoaded !== exports.isBuilderLoaded) {\r\n            exports.features.forEach((f) => f.processor.OnLoadBuilder());\r\n        }\r\n        exports.isBuilderLoaded = isLoaded;\r\n    }), 800);\r\n}))(chrome || browser);\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Utils_1 = require(\"../../shared/Utils\");\r\nconst FeatureBase_1 = require(\"./FeatureBase\");\r\nclass AutoTag extends FeatureBase_1.FeatureBase {\r\n    OnLoadBuilder() {\r\n        if (this.isEnabled) {\r\n            this.StartAsync();\r\n        }\r\n    }\r\n    StartAsync() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            Utils_1.default.interceptFunction(\"SidebarContentService\", \"showSidebar\", () => {\r\n                this.AddEventListeners();\r\n            });\r\n        });\r\n    }\r\n    AddEventListeners() {\r\n        const elements = document.querySelectorAll(\"li[ng-click^='$ctrl.onAddAction'], i[ng-click^='$ctrl.onDeleteAction']\");\r\n        const listener = (ev) => __awaiter(this, void 0, void 0, function* () {\r\n            yield this.FixWrongTags();\r\n        });\r\n        elements.forEach((e) => {\r\n            e.removeEventListener(\"click\", listener);\r\n            e.addEventListener(\"click\", listener);\r\n        });\r\n    }\r\n    FixWrongTags() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const enteringCustomActions = yield Utils_1.default.getBuilderControllerVariable(\"editingState.$enteringCustomActions\");\r\n            const leavingCustomAction = yield Utils_1.default.getBuilderControllerVariable(\"editingState.$leavingCustomActions\");\r\n            const actions = [...enteringCustomActions, ...leavingCustomAction];\r\n            const tags = yield Utils_1.default.getBuilderControllerVariable(\"editingState.$tags\");\r\n            console.log(tags);\r\n            console.log(actions);\r\n        });\r\n    }\r\n}\r\nexports.default = AutoTag;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass FeatureBase {\r\n    constructor() {\r\n        this.isEnabled = false;\r\n    }\r\n    OnEnableFeature() {\r\n        this.isEnabled = true;\r\n    }\r\n    OnDisableFeature() {\r\n        this.isEnabled = false;\r\n    }\r\n    OnReceiveConfiguration(configuration) {\r\n        this.configuration = configuration;\r\n    }\r\n}\r\nexports.FeatureBase = FeatureBase;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = ((brow) => {\r\n    var _a;\r\n    let storage = null;\r\n    const ensureHasStorage = () => new Promise((resolve) => {\r\n        if (!storage) {\r\n            try {\r\n                storage = brow.storage.sync.get(\"settings\", (result) => {\r\n                    storage = result && result.settings;\r\n                    resolve();\r\n                });\r\n            }\r\n            catch (_a) {\r\n                resolve();\r\n            }\r\n        }\r\n        else {\r\n            resolve();\r\n        }\r\n    });\r\n    const syncStorage = () => __awaiter(this, void 0, void 0, function* () {\r\n        yield ensureHasStorage();\r\n        brow.storage.sync.set({\r\n            settings: storage,\r\n        });\r\n    });\r\n    return _a = class Storager {\r\n        },\r\n        _a.get = (key) => __awaiter(this, void 0, void 0, function* () {\r\n            yield ensureHasStorage();\r\n            let current = storage || {};\r\n            if (key) {\r\n                const keys = key.split(\".\");\r\n                for (const path of keys) {\r\n                    if (current.hasOwnProperty(path)) {\r\n                        current = current[path];\r\n                    }\r\n                    else {\r\n                        return null;\r\n                    }\r\n                }\r\n            }\r\n            return current;\r\n        }),\r\n        _a.set = (key, value) => __awaiter(this, void 0, void 0, function* () {\r\n            yield ensureHasStorage();\r\n            let current = storage || {};\r\n            const keys = key.split(\".\");\r\n            for (let i = 0; i < keys.length; i++) {\r\n                const path = keys[i];\r\n                if (i === keys.length - 1) {\r\n                    current[path] = value;\r\n                    break;\r\n                }\r\n                else if (!storage.hasOwnProperty(path)) {\r\n                    current[path] = {};\r\n                }\r\n                current = current[path];\r\n            }\r\n            yield syncStorage();\r\n        }),\r\n        _a.clear = () => __awaiter(this, void 0, void 0, function* () {\r\n            storage = {};\r\n            yield syncStorage();\r\n        }),\r\n        _a.refresh = () => __awaiter(this, void 0, void 0, function* () {\r\n            storage = null;\r\n            yield ensureHasStorage();\r\n        }),\r\n        _a;\r\n})(chrome || browser);\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Utils {\r\n    static getRandomId() {\r\n        return Math.random().toString(36).substr(2, 9);\r\n    }\r\n    static getBuilderControllerVariable(path) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this.getBuilderControllerVariableInjected) {\r\n                yield Utils.injectPageScript(\"js/inject.js\");\r\n                this.getBuilderControllerVariableInjected = true;\r\n            }\r\n            return new Promise((resolve) => {\r\n                const identifier = this.getRandomId();\r\n                const listener = (ev) => {\r\n                    if (ev.data && ev.data.type === \"controller-variable-result\" && ev.data.id === identifier) {\r\n                        window.removeEventListener(\"message\", listener);\r\n                        return resolve(ev.data.value);\r\n                    }\r\n                };\r\n                window.addEventListener(\"message\", listener);\r\n                window.postMessage({\r\n                    id: identifier,\r\n                    route: path,\r\n                    type: \"controller-variable\",\r\n                }, \"*\");\r\n            });\r\n        });\r\n    }\r\n}\r\nUtils.interceptFunction = (path, func, action) => {\r\n    window.addEventListener(\"message\", (ev) => {\r\n        if (ev.data && ev.data.type === \"intercept-function-result\" && ev.data.id === path + func) {\r\n            action();\r\n        }\r\n    });\r\n    window.postMessage({\r\n        function: func,\r\n        route: path,\r\n        type: \"intercept-function\",\r\n    }, \"*\");\r\n};\r\nUtils.injectPageScript = (file) => __awaiter(this, void 0, void 0, function* () {\r\n    const brow = chrome || browser;\r\n    const src = brow.extension.getURL(file);\r\n    const element = document.createElement(\"script\");\r\n    element.src = src;\r\n    document.head.appendChild(element);\r\n    return new Promise((resolve) => {\r\n        element.addEventListener(\"load\", () => {\r\n            resolve();\r\n        });\r\n    });\r\n});\r\nUtils.getBuilderControllerVariableInjected = false;\r\nexports.default = Utils;\r\n"],"sourceRoot":""}